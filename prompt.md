#### 指示

あなたは、一枚の画像に含まれる複数の複雑な階層構造を持つ表を、単一の構造化されたJSONデータに変換する専門家です。
添付された画像内の表形式データを解析し、以下の**「事前定義キー一覧」**と**「JSON変換ルール」**に厳密に従って、汎用性の高いJSON形式に変換してください。
画像の解析補助として、表のHTML構造も併せて提供される場合があります。

---
#### 事前定義キー一覧

**# 都道府県**
`北海道`, `青森`, `岩手`, `宮城`, `秋田`, `山形`, `福島`, `茨城`, `栃木`, `群馬`, `埼玉`, `千葉`, `東京`, `神奈川`, `新潟`, `富山`, `石川`, `福井`, `山梨`, `長野`, `岐阜`, `静岡`, `愛知`, `三重`, `滋賀`, `京都`, `大阪`, `兵庫`, `奈良`, `和歌山`, `鳥取`, `島根`, `岡山`, `広島`, `山口`, `徳島`, `香川`, `愛媛`, `高知`, `福岡`, `佐賀`, `長崎`, `熊本`, `大分`, `宮崎`, `鹿児島`

**# 地域小計**
`東北`, `関東`, `北陸`, `中部`, `近畿`, `中国`, `四国`, `九州`

**# 断熱地域別**
`1地域`, `2地域`, `3地域`, `4地域`, `5地域`, `6地域`, `7地域`, `8地域`

**# 工法別**
`在来`, `プレハブ`, `2×4`

---
#### JSON変換ルール

**1. 基本構造と動的キー生成:**

*   JSONの最も外側は、配列 `[]` とします。
*   JSONの各オブジェクトの`indicator`キーには、**表の横方向における最上位の論理的なデータセクションのタイトル**を、画像とHTMLから正確に抽出し、一字一句そのまま使用してください。
*   この`indicator`は、表の大きな見出し（例：「6－①．総開口部数」、「6－②．㎡あたり開口部数」、「7．一戸あたり開口部数」）に対応します。
*   複数の主要タイトルがある場合は、**必ずそれぞれを別のオブジェクトとして配列に含めてください。**
*   主要なタイトルに含まれる階層コード（Ⅰ-1-⑴-①形式）を解析し、`code_display`キーに元の文字列、`code`キーに階層構造オブジェクトを含めてください。
    *   `code`オブジェクトは、`part`（Ⅰ,Ⅱ,Ⅲ...）、`chapter`（1,2,3...）、`section`（⑴,⑵,⑶...）、`item`（①,②,③...）の4階層を持ちます。
    *   各階層の値は数値型とし、該当する階層がない場合は`null`としてください。
    *   例：「Ⅰ-1」→ `{"part": 1, "chapter": 1, "section": null, "item": null}`
    *   例：「Ⅰ-1-①」→ `{"part": 1, "chapter": 1, "section": null, "item": 1}`
    *   例：「Ⅰ-1-⑴-①」→ `{"part": 1, "chapter": 1, "section": 1, "item": 1}`
*   画像の下部にある**ページ番号**を抽出し、各オブジェクトの`page`キーの値として数値型で含めてください。
*   各オブジェクトは、`indicator`、`code_display`、`code`、`page`、`総計`、`データ一覧`というキーを持ちます。

**2. 列ヘッダーの抽出:**

*   `総計`オブジェクトおよび`データ一覧`内の各`data`オブジェクトで使用するキーは、**各データ列の直上にある列ヘッダーテキストを、画像とHTMLから正確に読み取って使用してください。**
*   **【重要】親ヘッダーとの結合禁止:**
    *   **複数階層の列ヘッダーがある場合でも、親ヘッダー（上位のまとめヘッダー）と子ヘッダー（各データ列の直上のヘッダー）を結合してはいけません。**
    *   キー名として使用するのは、**各データ列の直上にあるヘッダーテキストのみ**です。
    *   例：「総開口部数」という親ヘッダーの下に「窓」という子ヘッダーがある場合、キー名は「窓」であり、「総開口部数_窓」ではありません。
*   **列ヘッダー抽出の基本ルール:**
    *   HTMLが提供されている場合は、HTMLを参考にして列ヘッダーを特定してください。HTMLが不完全な場合は画像を参照してください。
    *   列ヘッダーのテキストは**一切変更・省略・追加・解釈せず、画像とHTMLに書かれている文字列を一字一句そのまま使用**してください。
    *   改行（`<br/>`など）が含まれている場合は除去してください。
    *   単位表記（例：「(%)」「(棟)」など）が列ヘッダーに含まれている場合は、それも含めてキー名としてください。
    *   全角・半角の記号（例：「－」「＋」「．」「×」）や空白についても、画像に表示されているものを厳密に再現してください。
    *   数値データの列と列ヘッダーの位置関係を正確に対応させ、列のズレが発生しないよう注意してください。
*   **列ヘッダーの重複について:**
    *   列ヘッダー名が重複する場合でも問題ありません。主要なタイトル（`indicator`）ごとに別のオブジェクトとして配列に格納するルールに従えば、適切に解決できます。

**3. 【最重要】表の構造認識に関するルール:**

*   **「－」(ハイフン)の扱い:**
    *   表中に多数存在する「－」という文字は、**データ値を表すものであり、表の罫線や区切り線といった構造要素では決してありません。**
    *   したがって、**「－」を含む行を区切り線と誤認して無視したり、行数を乱したりすることは絶対に避けてください。** 「－」を含む行も、他の行と全く同じように、一つの完全なデータ行として扱ってください。
*   **ラベル特定ルール:**
    *   各データ行のラベルは、その行の左端に直接記載されている最も具体的な文字列（例：「青森」、「東北 計」、「1地域」）です。

**4. 総計データ:**

*   `総計`キーの値には、各indicatorに対応する表の一番上の行にある全体の合計値を格納するオブジェクトを作成します。
*   このオブジェクトのキーは、**ルール2**に従い、画像から動的に抽出した列ヘッダーを使用してください。

**5. データ一覧の作成:**

*   `データ一覧`キーの値は、**配列 `[]`** とします。
*   各indicatorに対応する表の各データ行（「総計」行を除く）を上から順番に処理し、それぞれを一つのオブジェクトとして、この配列に追加してください。**行の順番を絶対に入れ替えてはいけません。**
*   配列に追加する各オブジェクトは、`type`, `name`, `data`のキーを持つ必要があります。これらの値は以下の手順で決定します。
    *   **手順1: タイプの決定**
        *   行のラベルが**「事前定義キー一覧」**のどのリストに含まれるかを照合し、`type`を決定します。（例：「青森」なら`"都道府県"`、「1地域」なら`"断熱地域別"`）
        *   ラベルが`地域小計`リストの項目に「 計」を付けたもの（例: `東北 計`）と一致する場合、`type`は`"地域小計"`とします。
    *   **手順2: 名前の決定**
        *   `name`には、**「事前定義キー一覧」にある通りの正確な文字列**を格納します。「地域小計」の場合は、「 計」を取り除いた名前（例: `東北`）を使用します。
    *   **手順3: データの格納**
        *   `data`には、その行の数値データを格納するオブジェクトを作成します。
        *   このオブジェクトのキーは、**ルール2**に従い、画像から動的に抽出した列ヘッダーを使用してください。

**6. 値の扱い:**

*   数値はJSONの**数値型**にしてください。
*   `data`オブジェクト内において、元の表で「－」だった値は、JSONの `null` に変換してください。**すべての列ヘッダーに対応するキーは、値が`null`の場合でも省略せず含めてください。**
*   **注意:** 「地域小計」の数値は、AIが再計算するのではなく、画像に記載されている値をそのまま使用してください。

---
#### 最終的な出力形式について

*   上記のルールに従ったJSONコードブロックのみを出力してください。説明文や前置きは一切不要です。
*   **（参考）** 出力されるJSONは配列形式で、各要素には以下のキーが含まれます:
    *   `year`: 年情報（後処理で追加されます）
    *   `indicator`: 主要タイトル（画像上部から抽出）
    *   `code_display`: 階層コードの元の文字列（例：「Ⅰ-1-⑴-①」）
    *   `code`: 階層構造オブジェクト（part/chapter/section/itemを数値で保持）
    *   `page`: ページ番号（画像下部から抽出）
    *   `総計`: 全体の合計値を持つオブジェクト
    *   `データ一覧`: 各データ行の配列
*   列ヘッダー名やその他すべての値は、**画像とHTMLに書かれているものをそのまま転記**してください。自分で名前を考えたり解釈したりしないでください。

---
#### 出力例

以下は、上記ルールに従った出力の構造例です。実際の値は画像から抽出されます。

```json
[
  {
    "year": "2023",
    "indicator": "6－①．総開口部数",
    "code_display": "6－①",
    "code": {
      "part": null,
      "chapter": 6,
      "section": 1,
      "item": null
    },
    "page": 42,
    "総計": {
      "窓＋勝手口＋玄関": 15234,
      "窓": 12456,
      "勝手口": 1890,
      "玄関": 888
    },
    "データ一覧": [
      {
        "type": "都道府県",
        "name": "北海道",
        "data": {
          "窓＋勝手口＋玄関": 1234,
          "窓": 1000,
          "勝手口": 150,
          "玄関": 84
        }
      },
      {
        "type": "都道府県",
        "name": "青森",
        "data": {
          "窓＋勝手口＋玄関": null,
          "窓": null,
          "勝手口": null,
          "玄関": null
        }
      },
      {
        "type": "地域小計",
        "name": "東北",
        "data": {
          "窓＋勝手口＋玄関": 2345,
          "窓": 1890,
          "勝手口": 289,
          "玄関": 166
        }
      }
    ]
  },
  {
    "year": "2023",
    "indicator": "6－②．㎡あたり開口部数",
    "code_display": "6－②",
    "code": {
      "part": null,
      "chapter": 6,
      "section": 2,
      "item": null
    },
    "page": 42,
    "総計": {
      "窓": 0.95,
      "勝手口": 0.14,
      "玄関": 0.07
    },
    "データ一覧": [
      {
        "type": "都道府県",
        "name": "北海道",
        "data": {
          "窓": 0.92,
          "勝手口": 0.13,
          "玄関": 0.08
        }
      }
    ]
  }
]
```

**重要な注意事項:**
- 上記の例における列ヘッダー名（「窓＋勝手口＋玄関」「窓」など）や`indicator`の値は、あくまで**例示**です。
- 実際の出力では、**画像とHTMLに書かれている文字列をそのまま使用**してください。
- 親ヘッダーと子ヘッダーを結合せず、**各データ列の直上のヘッダーのみ**をキー名として使用してください。
